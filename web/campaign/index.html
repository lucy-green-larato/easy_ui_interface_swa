<!-- web/campaign/index.html 27-10-2025 v 3 -->
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Inside Track Sales Accelerator · Campaign builder</title>
  <meta name="color-scheme" content="light dark" />
  <script>
    (function () {
      try {
        // Persisted theme (use either key if present)
        var theme = (localStorage.getItem('it-theme') || localStorage.getItem('theme') || '').toLowerCase();

        // Cookie fallback
        if (!theme) {
          var m = (document.cookie || '').match(/(?:^|;\s*)(?:it-theme|theme)=(dark|light)/i);
          theme = m ? m[1].toLowerCase() : '';
        }

        // OS preference fallback
        if (!theme && window.matchMedia) {
          theme = matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        }

        if (theme !== 'dark' && theme !== 'light') theme = 'light';
        document.documentElement.setAttribute('data-theme', theme);
      } catch (e) { /* no-op */ }
    })();

    // Keep in sync if another tab flips the theme
    window.addEventListener('storage', function (e) {
      if (e.key === 'it-theme' || e.key === 'theme') {
        var v = (e.newValue || '').toLowerCase();
        if (v === 'dark' || v === 'light') {
          document.documentElement.setAttribute('data-theme', v);
        }
      }
    });
  </script>
  <link rel="stylesheet" href="/styles.css?v=2025-10-09-fc2">
</head>

<body class="app-campaign">
  <!-- HEADER (reused shell) -->
  <header class="app-header topbar compact" role="banner">
    <div class="header-left">
      <a class="brand-link" href="/" aria-label="Back to Inside Track main menu" title="Back to main menu">
        <img class="logo" src="/assets/larato-logo-bullet.svg" alt="" aria-hidden="true" />
        <div class="brand-text">
          <h1 class="app-title">Inside Track Sales Accelerator</h1>
          <p class="kicker">Lead qualilfication</p>
        </div>
      </a>
    </div>
    <div class="header-right">
      <div class="calltype-mini" role="group" aria-labelledby="sales-model-label">
        <span id="sales-model-label" class="mini-label">Direct or partner sales</span>
        <select id="call_type" name="call_type" form="qual-form" required aria-describedby="call_type_error">
          <option value="">Select…</option>
          <option>Direct</option>
          <option>Partner</option>
        </select>
        <button id="themeToggle" class="chip chip-amethyst" type="button" aria-pressed="false"
          aria-label="Switch theme">
          <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false">
            <path d="M21 12.79A9 9 0 1111.21 3a7 7 0 109.79 9.79z"></path>
          </svg>
          <span class="sr-only">Theme</span>
        </button>
        <label class="remember">
          <input type="checkbox" id="remember_call_type" form="qual-form" /> Remember
        </label>
        <span id="call_type_error" class="error-inline" role="alert" aria-live="polite"></span>
      </div>

      <span class="model-note">
        <span class="label">Sales model in use:</span>
        <strong id="map-label">Direct</strong>
      </span>

      <button id="help" class="btn inline chip" type="button" title="About this tool">Help</button>
      <span id="user-badge" class="chip is-hidden" aria-live="polite" aria-atomic="true">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <circle cx="12" cy="7" r="4"></circle>
          <path d="M4 22c0-4 4-7 8-7s8 3 8 7"></path>
        </svg>
        <span id="user-email">Loading…</span>
      </span>
    </div>
  </header>

  <main class="workboard">
    <!-- Left rail: inputs -->
    <label style="margin-top:8px">Sales model</label>
    <select id="salesModel">
      <option value="">(unspecified)</option>
      <option value="direct">Direct</option>
      <option value="partner">Partner</option>
    </select>
    <aside class="panel left card rail" id="inputs">
      <div class="group">
        <h3>Data source</h3>
        <label for="runSelect">Pick a recent Power BI run</label>
        <select id="runSelect">
          <option value="">(coming soon)</option>
        </select>
        <div class="muted" style="margin-top:6px">or</div>
        <label for="csvUpload" style="margin-top:6px">Upload CSV (testing only)</label>
        <input id="csvUpload" type="file" accept=".csv" />
        <div style="display:flex; gap:8px; align-items:center; margin-top:8px">
          <button id="goBtn" class="btn primary btn-cta" disabled>Go</button>
          <div class="muted"><span id="csvBadge">(no file)</span></div>
        </div>
      </div>

      <div class="group">
        <h3>Company</h3>
        <label>Company name</label>
        <input id="companyName" type="text" placeholder="Comms 365" />
        <label style="margin-top:8px">Website</label>
        <input id="companyWebsite" type="url" placeholder="https://www.example.com" />
        <label style="margin-top:8px">LinkedIn</label>
        <input id="companyLinkedIn" type="url" placeholder="https://www.linkedin.com/company/..." />
        <label for="buyerIndustry">Industry (optional)</label>
        <input id="buyerIndustry" name="buyerIndustry" type="text" placeholder="e.g., Construction"
          list="industryOptions" />
        <datalist id="industryOptions"></datalist>
        <label style="margin-top:8px">USPs / differentiators</label>
        <textarea id="companyUsps" class="textarea" rows="3"
          placeholder="Resilient connectivity; Millisecond failover"></textarea>
      </div>

      <div class="group">
        <h3>Options</h3>
        <label>Page (folder key)</label>
        <input id="pageKey" type="text" placeholder="Direct" value="Direct" />
        <label style="margin-top:8px">Tone</label>
        <select id="tone">
          <option value="match">Match company website (recommended)</option>
          <option value="professional" selected>Professional</option>
          <option value="warm">Warm</option>
        </select>
        <label style="margin-top:8px">Evidence window (months)</label>
        <select id="evidenceWindow">
          <option>6</option>
          <option>9</option>
          <option>12</option>
        </select>
        <label style="display:flex; align-items:center; gap:8px; margin-top:8px">
          <input id="includeCompliance" type="checkbox" checked /> Include compliance footer
        </label>
      </div>

      <div class="group">
        <h3>Status</h3>
        <div><span id="statusDot" class="status-dot"></span><span id="statusText">Idle</span></div>
        <div class="muted" style="margin-top:6px">Run: <span id="currentRunId">–</span></div>
      </div>
    </aside>

    <!-- Center: workspace -->
    <section class="panel middle card workspace">
      <div class="tabs">
        <div class="tabs-left" id="sectionTabs" role="tablist" aria-label="Campaign sections"></div>
      </div>
      <div class="panel" id="centerPanel"></div>
      <div id="runBadge" class="muted">Run: <span id="runBadgeId">–</span></div>
    </section>

    <!-- Right rail: assist / tips -->
    <aside class="panel right card assist">
      <div class="section">
        <strong>Tips</strong>
        <ul class="list">
          <li>Upload a CSV, adjust options, then press <em>Go</em>.</li>
          <li>When status reaches <em>Completed</em>, the tabs will populate automatically.</li>
        </ul>
      </div>
      <div class="section">
        <strong>Debug</strong>
        <div class="pre" id="debugLog" style="max-height:42vh; overflow:auto;"></div>
      </div>
    </aside>
  </main>
  <noscript>
    <div class="card" style="margin:1rem; padding:1rem;">
      JavaScript is required to run the Campaign builder UI.
    </div>
  </noscript>
  <div id="campaign-toast" class="toast"></div>
  <script src="/src/js/campaign.js" defer></script>
</body>

</html>